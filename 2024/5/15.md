# 取り組んだ内容一覧
- SQL実践入門

# わかったこと
- メモリなどの一次記憶装置は HDD などの二次記憶装置と比べるとアクセス速度が早い。その代わりにコストも高い。一台のハードウェアに搭載できる量はそこまで多くない。
- HDD などのディスクへのアクセスを回避できればパフォーマンス改善が可能。
- パフォーマンスの向上を目的としてデータを保持するメモリを、「バッファ」や「キャッシュ」と呼ぶ。
- 高速アクセス可能なバッファに、どのようなデータをどの程度の期間載せておくかといったことを管理する機能が、DBMSのバッファマネージャである。
- DBMS がデータを保持するために使うメモリには大きく次の3種類がある。
  - データキャッシュ
  - ログバッファ
  - ワーキングメモリ
- データキャッシュとは、ディスクにあるデータの一部を保持するためのメモリ領域。
- ログバッファとは、更新処理(INSERT, DELETE, UPDATE)の実行時に利用される。DBMS はこれらの更新 SQL をユーザーから受け取った時、すぐにストレージ上のデータを変更しているわけではない。一度、ログバッファ上に更新情報を溜めて、ディスクへの更新は後でまとめて行っている。言い換えると、commit 時にメモリからディスクへ情報をコピーしているということ。
- データベースは検索を重視したメモリ配分をしている。DBMS のいくつかにおいて、デフォルト設定値がデータキャッシュに比べてログバッファの方が非常に小さい。これはデータベースが基本的に検索をメインの処理と想定しているミドルウェアだということ。更新に貴重なメモリを多く割くよりは検索処理でヒットしそうなデータをキャッシュに載せておくほうが得策だというのがデータベースの基本精神になっている。
- 常に検索を重視するべきというわけではなく、検索に比べて更新量の多い業務特性を持っているなら（例えばバッチ処理がメインの場合）、デフォルト設定のままでは更新のパフォーマンスが悪いこともある。そういったときは、ログバッファにより多くのメモリを割り当てるというチューニング（最適化）が必要になる。
- ワーキングメモリとは、ソートやハッシュなど特定の処理に利用される作業用の領域。通常はデータキャッシュやログバッファとは別の領域として管理されていることが多い。もしこの領域が扱うデータ量に対して小さく不足した場合、多くの DBMS はストレージを使用する。データ量が増えてメモリに収まりきらない場合、ストレージを使うことになる。ストレージが使われると低速になる。この領域は複数の SQL 文で共有して使用されるため、一つの SQL 文を実行しているときはメモリ内に収まっていたのが、複数の SQL 文を同時に実行した際に収まりきらず、溢れてしまうというケースもある。このような状態を再現するテストを実施しないと判明しないという難しさがある。

# 次やること
- SQL実践入門

# 学習時間
Today: 1 h 15 m

Total: 949 h 20 m
